<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>주문 확인</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $("form").on("submit", function(event) {
                event.preventDefault();

                alert("주문 완료되었습니다");

                if (confirm("주문을 확인하시겠습니까?")) {
                    this.submit();
                }else {
                    window.location.href = "/menu";
                }
            });
        });
    </script>
</head>
<body>
<h1>주문 확인</h1>
<p th:text="${loginUser.name} + '님!'"></p>

<h2>주문 내역</h2>
<table>
    <tr>
        <th>메뉴 이름</th>
        <th>가격</th>
        <th>수량</th>
        <th>합계</th>
    </tr>
    <tr th:each="item : ${cartItems}">
        <td th:text="${item.menuDTO.name}"></td>
        <td th:text="${item.menuDTO.price}"></td>
        <td th:text="${item.menuCount}"></td>
        <td th:text="${item.menuDTO.price * item.menuCount}"></td>
    </tr>
</table>
<p>총 가격: <span th:text="${totalPrice} + '원'"></span></p>

<h3>결제 방식</h3>
<form th:action="@{/orders/success}" method="post">
    <select name="paymentMethod">
        <option value="card">카드 결제</option>
        <option value="meet">만나서 결제</option>
    </select>
    <button type="submit">주문 확인</button>
</form>

<p th:if="${errorMessage != null}" th:text="${errorMessage}"></p>
</body>
</html>
